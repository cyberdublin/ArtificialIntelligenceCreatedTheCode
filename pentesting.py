import nmap
import socket
import requests
import os

def banner():
    print("""
    ================================
          Basic Pentesting Tool
    ================================
    """)

def network_scan(target_ip):
    print(f"\n[+] Scanning {target_ip} for open ports...")
    scanner = nmap.PortScanner()
    scanner.scan(target_ip, '1-65535', '-v')
    
    for host in scanner.all_hosts():
        print(f"Host: {host} ({scanner[host].hostname()})")
        print(f"State: {scanner[host].state()}")
        
        for proto in scanner[host].all_protocols():
            print(f"\nProtocol: {proto}")
            ports = scanner[host][proto].keys()
            for port in ports:
                print(f"Port: {port}, State: {scanner[host][proto][port]['state']}")
    return scanner

def website_recon(target_url):
    print(f"\n[+] Gathering information about {target_url}...")
    try:
        response = requests.get(target_url)
        print(f"HTTP Status Code: {response.status_code}")
        print(f"Headers: {response.headers}")
        print("\nHTML Title:")
        title_start = response.text.find('<title>')
        title_end = response.text.find('</title>')
        if title_start != -1 and title_end != -1:
            print(response.text[title_start + 7:title_end])
        else:
            print("No title found.")
    except requests.RequestException as e:
        print(f"Error during HTTP request: {e}")

def dns_lookup(target_domain):
    print(f"\n[+] Performing DNS Lookup for {target_domain}...")
    try:
        ip = socket.gethostbyname(target_domain)
        print(f"IP Address: {ip}")
    except socket.gaierror as e:
        print(f"Error: {e}")

def whois_lookup(domain):
    print(f"\n[+] Performing WHOIS lookup for {domain}...")
    try:
        if not os.system("which whois > /dev/null"):
            os.system(f"whois {domain}")
        else:
            print("`whois` command not found. Please install it to use this feature.")
    except Exception as e:
        print(f"Error: {e}")

def main():
    banner()
    
    print("Choose a task to perform:")
    print("1. Network Scan (Nmap)")
    print("2. Website Reconnaissance")
    print("3. DNS Lookup")
    print("4. WHOIS Lookup")
    print("5. Exit")
    
    while True:
        choice = input("\nEnter your choice: ")
        if choice == "1":
            target_ip = input("Enter the target IP address: ")
            network_scan(target_ip)
        elif choice == "2":
            target_url = input("Enter the target URL (e.g., http://example.com): ")
            website_recon(target_url)
        elif choice == "3":
            target_domain = input("Enter the domain name: ")
            dns_lookup(target_domain)
        elif choice == "4":
            target_domain = input("Enter the domain name: ")
            whois_lookup(target_domain)
        elif choice == "5":
            print("Exiting...")
            break
        else:
            print("Invalid choice. Please choose again.")

if __name__ == "__main__":
    main()

